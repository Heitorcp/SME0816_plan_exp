---
title: "SME0816 - Planejamento de Experimentos I"
subtitle: "Trabalho 5 - Grupo 13"
author:
  - Beatriz Proença Carvalho
  - Francisco Rosa Dias de Miranda 4402962
  - Heitor Carvalho Pinheiro 11833351
date: "Maio 2022"
output: pdf_document
---


\centering
\raggedright
\newpage
\tableofcontents
\newpage


```{r setup, include=FALSE, message=F}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(multcomp, quietly = T)
library(gmodels)
```

# Exercício 01

Foi realizado um experimento inteiramente casualizado com quatro tratamentos e 4 repetições, para estudar
os efeitos de *Bacitracina de zinco (BDZ)* e *Anti-stress* no índice de conversão alimentar de frangos de corte, no período de 4 a 35 dias de idade, alimentados com rações à base de sorgo. Foram utilizados 540 pintos da raça “Cobb-100” da Granja Avisco - Mococa, SP., e os tratamentos empregados estão descritos na Tabela 01:

* Tratamentos:

  - A: Concentrado Comercial + Milho
  - B: Concentrado Comercial + Sorgo
  - C: Concentrado Comercial + Sorgo + BDZ
  - D: Concentrado Comercial + Sorgo + Anti-Stress

```{r}
#Tabela 01

y <- c(2.10, 1.99, 2.02, 2.00, 2.35,2.26,2.18,2.17,2.02,2.04,2.03,2.05,2.19,2.11,2.29,2.30)

trat <- c(rep("A",4), rep("B",4), rep("C",4), rep("D",4))

trat <- as.factor(trat)

#creating a dataframe

df02 <- data.frame(trat,y)

#length of each treatment
n <- tapply(df02$y, df02$trat, length)

#mean of each treatment
means <- tapply(df02$y, df02$trat, mean)

#variances
sds <- tapply(df02$y, df02$trat, sd)

#summary dataframe

df02_ <- data.frame(n,means, round(sds,2))

```

Considere um nível de significância de 5%.

No estudo, em questão podemos considerar que os grupos (A,B) representam dois grupos controle distintos e (C,D) representariam o nosso grupo experimental.

## Variável resposta e sua unidade

A unidade resposta é a *conversão alimentar* uma medida da produtividade de rebanhos e criações. É definida como o consumo total de ração por um animal dividido pelo peso ganho pelo animal. Essa grandeza não possui unidade.

$FCR = \frac{Consumo total de alimento}{Ganho de massa corporal}$
 
O Índice de Conversão Alimentar (FCR) é adimensional, pois é razão das mesmas unidades de medida. (Em geral, kg)

## Interpretação

Quanto menor o $Feed Conversion rate (FCR)$ maior a produtividade e eficiência do animal.

## Índices de conversão maiores ou menores?

São desejáveis índices menores, que indicam uma maior conversão da respectiva dieta no peso das aves.

## Parcela utilizada

```{r}
length(trat)/16
```

A parcela utilizada possui tamanho 1.

## Análise de variância

### Pressuposições básicas do modelo

```{r}
#Verificando as pressuposições do para a ANOVA

# Analise Exploratoria rapida

boxplot(split(df02$y, df02$trat))
```
A partir do boxplot, verifica-se que existe alguma diferença entre os tratamentos, Precisamos saber se as diferenças nas médias são significativas.

Assumiremos uma $H_0$ de que não há diferença entre as médias dos tratamentos C e D.


Faremos o ajuste do modelo ANOVA para verificar seus respectivos resíduos

```{r}
fit <- df02 %>% aov(y ~ trat, data = .)
```



#### Normalidade dos resíduos

```{r}
ggplot() +
  geom_point(aes(y = fit$residuals, x = fit$fitted.values)) +
  labs( x= "Resíduos",
        y = "Valores Ajustados",
        title = "Resíduos versus valores ajustados")
```


```{r}
shapiro.test(fit$residuals)
```

Utilizando o teste de Shapiro-Wilk para testar a normalidade dos resídos, obtivemos um p-valor de 0,9142, o que não rejeita a hipótese nula, de normalidade dos dados, a um nível de significância de 5%.


### Existe efeito de tratamento?


```{r}
summary(fit)
```

Como o p-valor é menor que nosso nível de significância, podemos concluir que existem diferenças significativas entre os grupos, ou seja, um nível de confiança de 95% nos faz concluir de que pelo menos uma das médias dos grupos diferem.


### Desdobramento dos graus de liberdade de tratamentos para um grupo de contrastes mutuamente ortogonais.


```{r}

trat <- gl(4,4)

trat1 <- c(1,-1/3,-1/3,-1/3)
trat2 <- c(0,1,-1/2,-1/2)
trat3 <- c(0,0,1,-1)

contrasts(trat)<- cbind(trat1,
                        trat2,
                        trat3)

c1 <- rbind(trat1,
            trat2,
            trat3)

rownames(c1) <- paste("contr", 1:3, sep = "")
c1

mod2 <- aov(y ~ trat, data = df02, contrast = list(trat = make.contrasts(c1)))
summary(mod2, split = list(trat = 1:3))

fit.contrast(mod2, "trat", c1)
```

### Contrastes utilizados

```{r}
c1

```






### Conclusões


```{r}


modelo <- lm(y~trat, data = df02)
summary(glht(modelo,linfct=mcp(trat=trat1)))

```

```{r}
summary(glht(modelo,linfct=mcp(trat=trat2)))
```

```{r}

summary(glht(modelo,linfct=mcp(trat=trat3)))

```
g) Verifique se, em média, o contraste formado pelos tratamentos (A, B) vs (C, D) é significativo.

